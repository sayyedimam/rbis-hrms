<div class="app-layout-wrapper" *ngIf="authService.isLoggedIn()">
  <!-- Main Header -->
  <header class="app-header">
    <div class="header-left">
      <h1 class="app-brand" routerLink="/dashboard" style="cursor: pointer">
        RBIS <span>HR Management System</span>
      </h1>
    </div>
    <div class="header-right">
      <div class="user-profile-wrapper">
        <div class="user-profile" (click)="toggleProfileMenu()">
          <div class="user-info">
            <span class="user-name">{{ getUserDisplayName(currentUser) }}</span>
            <span class="user-role">{{ currentUser?.role }}</span>
          </div>
          <div class="user-avatar-circle">
            {{ getInitials(currentUser) }}
          </div>
        </div>

        <!-- Profile Dropdown (Logout moves here) -->
        <div class="profile-dropdown" *ngIf="profileMenuOpen">
          <a
            routerLink="/profile"
            (click)="profileMenuOpen = false"
            class="dropdown-item"
          >
            <i data-lucide="user"></i> My Profile
          </a>
          <hr />
          <button class="btn-logout-dropdown" (click)="logout()">
            <i data-lucide="log-out"></i>
            <span>Logout</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Horizontal Top Navigation (Restored Design) -->
  <nav class="hrms-top-nav">
    <div class="nav-container">
      <a routerLink="/dashboard" routerLinkActive="active" class="nav-item">
        <i data-lucide="layout-dashboard"></i> Dashboard
      </a>
      <a routerLink="/analytics" routerLinkActive="active" class="nav-item">
        <i data-lucide="bar-chart-2"></i> Analytics
      </a>
      <a
        routerLink="/attendance-operations"
        routerLinkActive="active"
        class="nav-item"
        *ngIf="isAdmin"
      >
        <i data-lucide="settings"></i> Operations
      </a>
      <a
        routerLink="/onboarding"
        routerLinkActive="active"
        class="nav-item"
        *ngIf="isHr"
      >
        <i data-lucide="user-plus"></i> OnBoarding
      </a>
      <a
        routerLink="/records"
        routerLinkActive="active"
        class="nav-item"
        *ngIf="isCeo"
      >
        <i data-lucide="archive"></i> Records
      </a>
      <a
        routerLink="/employee-management"
        routerLinkActive="active"
        class="nav-item"
        *ngIf="isHr"
      >
        <i data-lucide="users"></i> Master Table
      </a>
      <a
        routerLink="/leave-management"
        routerLinkActive="active"
        class="nav-item"
      >
        <i data-lucide="calendar"></i> Leaves
      </a>
      <!-- <a routerLink="/notices" routerLinkActive="active" class="nav-item">
        <i data-lucide="bell"></i> Notices
      </a>
      <a
        routerLink="/admin/notices"
        routerLinkActive="active"
        class="nav-item"
        *ngIf="isHr"
      >
        <i data-lucide="megaphone"></i> Notice Mgmt
      </a> -->
    </div>
  </nav>

  <main class="page-content-container">
    <router-outlet></router-outlet>
  </main>
</div>

<!-- Non-logged in view (Login/Signup) -->
<div *ngIf="!authService.isLoggedIn()">
  <router-outlet></router-outlet>
</div>

<!-- Alerts / Toast Container (Fixed position) -->
<div class="alerts-container">
  <div *ngFor="let alert of alerts" class="alert-toast" [class]="alert.type">
    <div class="alert-icon">
      <i *ngIf="alert.type === 'success'" class="lucide-check-circle"></i>
      <i *ngIf="alert.type === 'error'" class="lucide-alert-circle"></i>
      <i *ngIf="alert.type === 'info'" class="lucide-info"></i>
    </div>
    <span class="alert-msg">{{ alert.message }}</span>
    <button class="alert-close" (click)="removeAlert(alert.id)">&times;</button>
  </div>
</div>
